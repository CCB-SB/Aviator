{% url 'main:index' as index %}
{% url 'main:overview' as overview %}
{% url 'main:publications' as publications %}
{% url 'main:author' as author %}
{% url 'main:statistics' as statistics %}
{% url 'main:api' as api %}

<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <a class="navbar-brand" href="{{ index }}">Aviator</a>
  <div class="navbar-login-container" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item {% if request.path == index %}active{% endif %}">
        <a class="nav-link" href="{{ index }}">Home</a>
      </li>
      <li class="nav-item {% if request.path == publications %}active{% endif %}">
        <a class="nav-link" href="{{ publications }}">Publications</a>
      </li>
      <li class="nav-item {% if request.path == author %}active{% endif %}">
        <a class="nav-link" href="{{ author }}">Contact</a>
      </li>
      <li class="nav-item {% if request.path == statistics %}active{% endif %}">
        <a class="nav-link" href="{{ statistics }}">Statistics</a>
      </li>
      <li class="nav-item {% if request.path == api %}active{% endif %}">
        <a class="nav-link" href="{{ api }}">API</a>
      </li>
    </ul>
    <form class="form-inline my-2 my-lg-0" action="{% url 'main:publications' %}" method="post">
      {% csrf_token %}
        <div class="dropdown">
          <button class="btn btn-secondary dropdown-toggle" type="button" id="ddBtnN" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Title&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          </button>
          <div class="dropdown-menu" aria-labelledby="ddBtn1">
            <a class="dropdown-item" onclick="document.getElementById('ddBtnN').innerHTML = this.innerHTML;document.getElementById('search_column').value = 0;return false;">Title&nbsp;&nbsp;&nbsp;&nbsp;</a>
            <a class="dropdown-item" onclick="document.getElementById('ddBtnN').innerHTML = this.innerHTML;document.getElementById('search_column').value = 3;return false;">Authors&nbsp;&nbsp;</a>
            <a class="dropdown-item" onclick="document.getElementById('ddBtnN').innerHTML = this.innerHTML;document.getElementById('search_column').value = 5;return false;">Journal&nbsp;&nbsp;</a>
            <a class="dropdown-item" onclick="document.getElementById('ddBtnN').innerHTML = this.innerHTML;document.getElementById('search_column').value = 6;return false;">Pubmed ID&nbsp;&nbsp;</a>
            <a class="dropdown-item" onclick="document.getElementById('ddBtnN').innerHTML = this.innerHTML;document.getElementById('search_column').value = 7;return false;">Abstract&nbsp;&nbsp;</a>
            <a class="dropdown-item" onclick="document.getElementById('ddBtnN').innerHTML = this.innerHTML;document.getElementById('search_column').value = 8;return false;">Original URL</a>
            <a class="dropdown-item" onclick="document.getElementById('ddBtnN').innerHTML = this.innerHTML;document.getElementById('search_column').value = 9;return false;">Derived URL</a>
          </div>
        </div>&nbsp;&nbsp;&nbsp;
      <input id="search_column" name="search_column" class="form-control mr-sm-2" type="hidden" placeholder="Search" aria-label="Search" value="0">
      <input id="nav_search" name="search_string" class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
      <button class="btn btn-outline-light my-2 my-sm-0" type="submit" onclick="">Search</button>
    </form>
  </div>
</nav>

<script>
  function createNavbarSearchData() {
    data = {};
    data[$('#search_column').val()] = $('#nav_search').val();
    data["q"] = $('#search_column').val();
    return data;
  }
  $( function() {
    $( "#nav_search" ).autocomplete({
      source: function(request, response) {
        $.getJSON("{% url 'main:autocomplete' %}", createNavbarSearchData(), response);
      },
      minLength: 1
    });
    if ($( "#nav_search" ).autocomplete().data("ui-autocomplete") != undefined) {
        $( "#nav_search" ).autocomplete().data("ui-autocomplete")._renderItem = function (ul, item) {
            var newText = String(item.value).replace(
            new RegExp(this.term, "gi"),
            "<span style='color: white;'><strong>$&</strong></span>");
            return $("<li></li>")
            .data("item.autocomplete", item)
            .append("<div>" + newText + "</div>")
            .appendTo(ul);
        };
    }
  } );
</script>
